<!DOCTYPE html>
<html>
<head>
  <title>Pi Network SDK Example</title>
</head>
<body>
  <h1>Pi Network SDK Example</h1>
  <button onclick="authenticate()">Authenticate</button>
  <button onclick="checkUserHasMiningApp()">Check if user has Mining App</button>
  <button onclick="checkUserHasPiBrowser()">Check if user has Pi Browser</button>
  <button onclick="copyText()">Copy text to clipboard</button>
  <button onclick="createPayment()">Create payment</button>
  <button onclick="getPiHostAppName()">Get Pi Host App Name</button>
  <button onclick="getPiHostAppInfo()">Get Pi Host App Info</button>
  <button onclick="nativeFeaturesList()">Get Native Features List</button>
  <button onclick="openConversation()">Open conversation</button>
  <button onclick="openShareDialog()">Open share dialog</button>
  <button onclick="openUrlInSystemBrowser()">Open URL in system browser</button>
  <button onclick="requestPermission()">Request permission</button>
  <button onclick="scanQrCode()">Scan QR code</button>

  <script>
    Pi.init({ version: "2.0", sandbox: false });

    // Example function
    const authenticate = () => {
      Pi.authenticate(['payments'], (error, result) => {
        if (error) {
          alert(error);
        } else {
          alert(result);
        }
      });
    };

    const checkUserHasMiningApp = () => {
      Pi.checkUserHasMiningApp().then((result) => {
        alert(result);
      });
    };

    const checkUserHasPiBrowser = () => {
      Pi.checkUserHasPiBrowser().then((result) => {
        alert(result);
      });
    };

    const copyText = () => {
      Pi.copyText('Hello world!').then(() => {
        alert('Text copied to clipboard.');
      });
    };

    const createPayment = () => {
      Pi.createPayment({
        amount: 10,
        memo: 'This is a test payment.',
        to_address: 'my_pi_address'
      }, (error, result) => {
        if (error) {
          alert(error);
        } else {
          alert(result);
        }
      });
    };

    const getPiHostAppName = () => {
      alert(Pi.getPiHostAppName());
    };

    const getPiHostAppInfo = () => {
      Pi.getPiHostAppInfo().then((result) => {
        alert(result);
      });
    };

    const nativeFeaturesList = () => {
      Pi.nativeFeaturesList().then((result) => {
        alert(result);
      });
    };

    const openConversation = () => {
      Pi.openConversation('my_conversation_id').then(() => {
        alert('Conversation opened.');
      });
    };

    const openShareDialog = () => {
      Pi.openShareDialog('My title', 'My sharing message').then(() => {
        alert('Share dialog opened.');
      });
    };

    const openUrlInSystemBrowser = () => {
      Pi.openUrlInSystemBrowser('https://www.minepi.com').then(() => {
        alert('URL opened in system browser.');
      });
    };

    const requestPermission = () => {
      Pi.requestPermission('camera').then((result) => {
        alert(result);
      });
    };

    const scanQrCode = () => {
      Pi.scanQrCode().then((result) => {
        alert(result);
      });
    };

    // Check if a new cache is available on page load.
    window.addEventListener('load', function(e) {

    window.applicationCache.addEventListener('updateready', function(e) {
      if (window.applicationCache.status == window.applicationCache.UPDATEREADY) {
        // Browser downloaded a new app cache.
        // Swap it in and reload the page to get the new hotness.
        window.applicationCache.swapCache();
        if (confirm('A new version of this site is available. Load it?')) {
          window.location.reload();
        }
      } else {
        // Manifest didn't changed. Nothing new to server.
      }
    }, false);

    }, false);
  </script>
  <script src="https://sdk.minepi.com/pi-sdk.js"></script>
</body>
</html>